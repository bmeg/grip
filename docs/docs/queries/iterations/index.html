<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
  <title>Iteration &middot; GRIP</title>
  

  
  <link rel="stylesheet" href="https://bmeg.github.io/grip/css/poole.css">
  <link rel="stylesheet" href="https://bmeg.github.io/grip/css/darcula.css">
  <link rel="stylesheet" href="https://bmeg.github.io/grip/css/syntax.css">
  <link rel="stylesheet" href="https://bmeg.github.io/grip/css/theme.css">
  <link rel="stylesheet" href="https://bmeg.github.io/grip/css/funnel.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://bmeg.github.io/grip/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://bmeg.github.io/grip/favicon.png">

  <script src="https://bmeg.github.io/grip/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>
<body>

  <div class="global-header">
    <div class="global-header-container">
      <div class="global-header-home">
        <a href="https://bmeg.github.io/grip"><h1>GRIP</h1></a>
      </div>
      <ul class="global-header-nav">
          <li><a href="https://bmeg.github.io/grip/download//">Download</a></li>
          <li><a href="https://bmeg.github.io/grip/docs/">Docs</a></li>
          <li><a href="https://github.com/bmeg/grip">GitHub</a></li>
          <li><a href="https://gitter.im/bmeg/grip">Chat</a></li>
        </ul>
      <div class="global-header-ohsucb">
        <a href="https://www.ohsu.edu/compbio/"><h2>OHSU Comp Bio</h2></a>
      </div>
    </div>
  </div>


<div class="content section group">

  <div class="sidebar col span_3_of_12">
    <ul class="sidebar-nav">
      
      
        
        <li>
          
          <a href="https://bmeg.github.io/grip/docs/"
             class="sidebar-nav-item "
          >Overview</a></li>
          
        
        <li>
          
          <a href="https://bmeg.github.io/grip/download/"
             class="sidebar-nav-item "
          >Download</a></li>
          
        
        <li>
          
          <span class="intermediate">GRIP Commands</span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/commands/server/"
                   class="sidebar-nav-item "
                >server</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/commands/query/"
                   class="sidebar-nav-item "
                >query</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/commands/list/"
                   class="sidebar-nav-item "
                >list</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/commands/drop/"
                   class="sidebar-nav-item "
                >drop</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/commands/mongoload/"
                   class="sidebar-nav-item "
                >mongoload</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/commands/er/"
                   class="sidebar-nav-item "
                >er</a></li>
            </ul>
          </li>
          
          
        
        <li>
          
          <span class="intermediate">Database Configuration</span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/databases/elastic/"
                   class="sidebar-nav-item "
                >Elasticsearch</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/databases/kvstore/"
                   class="sidebar-nav-item "
                >Embedded KV Store</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/databases/mongo/"
                   class="sidebar-nav-item "
                >MongoDB</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/databases/psql/"
                   class="sidebar-nav-item "
                >PostgreSQL</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/databases/sql/"
                   class="sidebar-nav-item "
                >SQL</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/databases/gripper/"
                   class="sidebar-nav-item "
                >GRIPPER</a></li>
            </ul>
          </li>
          
          
        
        <li>
          
          <span class="intermediate">GRIP Plugable External Resources</span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/gripper/gripper/"
                   class="sidebar-nav-item "
                >Intro</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/gripper/proxy/"
                   class="sidebar-nav-item "
                >External Resource Proxies</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/gripper/graphmodel/"
                   class="sidebar-nav-item "
                >Graph Model</a></li>
            </ul>
          </li>
          
          
        
        <li>
          
          <span class="intermediate">Query a Graph</span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/queries/getting_started/"
                   class="sidebar-nav-item "
                >Getting Started</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/queries/operations/"
                   class="sidebar-nav-item "
                >Operations</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/queries/jsonpath/"
                   class="sidebar-nav-item "
                >Referencing Fields</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/queries/iterations/"
                   class="sidebar-nav-item  active"
                >Iteration</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/queries/jobs_api/"
                   class="sidebar-nav-item "
                >Jobs API</a></li>
            </ul>
          </li>
          
          
        
        <li>
          
          <span class="intermediate">Tutorials</span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/tutorials/amazon/"
                   class="sidebar-nav-item "
                >Amazon Purchase Network</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/tutorials/tcga-rna/"
                   class="sidebar-nav-item "
                >TCGA RNA Expression</a></li>
            </ul>
          </li>
          
          
        
        <li>
          
          <span class="intermediate">Security</span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/security/basic/"
                   class="sidebar-nav-item "
                >Basic Auth</a></li>
            </ul>
          </li>
          
          
        
        <li>
          
          <span class="intermediate">GraphQL</span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/graphql/graphql/"
                   class="sidebar-nav-item "
                >GraphQL</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://bmeg.github.io/grip/docs/graphql/graph_schemas/"
                   class="sidebar-nav-item "
                >Graph Schemas</a></li>
            </ul>
          </li>
          
          
        
        <li>
          
          <span class="intermediate">Developers</span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://github.com/bmeg/grip/blob/master/gripql/gripql.proto"
                   class="sidebar-nav-item "
                >API</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="https://godoc.org/github.com/bmeg/grip"
                   class="sidebar-nav-item "
                >GoDoc</a></li>
            </ul>
          </li>
          
          
        
      
    </ul>
  </div>

  <div class="main col span_8_of_12">
    <h1 id="iteration-api">Iteration API</h1>
<p>A common operation in graph search is the ability to iterative repeat a search pattern.
For example, a &lsquo;friend of a friend&rsquo; search may become a &lsquo;friend of a friend of a friend&rsquo; search.</p>
<p>In the GripQL language cycles, iterations and conditional operations are encoded using
&lsquo;mark&rsquo; and &lsquo;jump&rsquo; based interface. This operations are similar to using a &lsquo;goto&rsquo;
statement in a traditional programming language. While more primitive than the
repeat mechanisms seen in Gremlin, this pattern allows for a much more simple
query compilation and implementation.</p>
<p>Because the mark and jump pattern can be abused for denial of service attacks,
ie to create infinite loops, the authorization model will allow this particular set
of operations to be turned off for some accounts. This means that queries from
unauthorized users that utilize the &lsquo;mark&rsquo; or &lsquo;jump&rsquo; commands will be rejected
by the server without execution. One additional proposed security feature, that
is being discussed for in future upgrades, will allow the server to
track the total number of iterations a traveler has made in a cycle, and provide a
hard cutoff. For example, a user could submit code with a maximum of 5 iterations.</p>
<h2 id="operation-commands">Operation Commands</h2>
<h3 id="markname">mark(name)</h3>
<p>Mark a segment in the stream processor, with a name, that can receive jumps</p>
<h3 id="jumpdest-condition-emit">jump(dest, condition, emit)</h3>
<p>If a condition is true, send traveler to mark. If emit is true, also send a
copy down the processing chain. If condition is None, always do the jump.</p>
<h3 id="setfield-value">set(field, value)</h3>
<p>Set values within the travelers memory. These values be used to store cycle counts</p>
<h3 id="incrementfield-value">increment(field, value)</h3>
<p>Increment field, ie <code>data[field] = data[field] + value</code>. Can be used to increment counter every cycle</p>
<h2 id="example-queries">Example queries</h2>
<pre tabindex="0"><code>q = G.query().V(&#34;Character:1&#34;).set(&#34;count&#34;, 0).as_(&#34;start&#34;).mark(&#34;a&#34;).out().increment(&#34;$start.count&#34;)
q = q.has(gripql.lt(&#34;$start.count&#34;, 2))
q = q.jump(&#34;a&#34;, None, True)
</code></pre>
  </div>

</div>
</body>
</html>
